// Contains
Element.prototype.is = function (el) {
	// If is same element
	return this === el;
};

// Material Design - Bottom sheet

(function () {
	"use strict";

	var MaterialSpeedDial = function (element) {
		this.element = element;
		this.init();
	};

	window.MaterialSpeedDial = MaterialSpeedDial;

	// Prototype

	MaterialSpeedDial.prototype = {
		// Element
		element: null,

		// Constants
		constants: {},

		// Classes
		classes: {
			speedDial: "material-speed-dial",
			active: "is-active"
		},

		// Init
		init: function () {
			var self = this,
				f = function (e) {
					if (e.target instanceof Element) {
						var target = e.target;
						var selector = $(self.element)
							.find(".aefis-speed-dial")
							.attr("data-aefis-fade-selector");
						if (selector) {
							var $selector = $(selector);
							$(selector).addClass("aefis-speed-dial-fade");
						}

						if (
							self.element.is(target) === true ||
							self.element.contains(target) === true
						) {
							self.element.classList.add(self.classes.active);
							setTimeout(function () {
								$("div.material-speed-dial.is-active")
									.find(".material-speed-dial--children")
									.each(function () {
										$(this).attr("tabindex", 0);
									});
							}, 300);
							if ($selector) {
								$selector.addClass("faded");
							}
						} else {
							self.element.classList.remove(self.classes.active);
							$("div.material-speed-dial")
								.find(".material-speed-dial--children")
								.each(function () {
									$(this).attr("tabindex", -1);
								});

							if ($selector) {
								$selector.removeClass("faded");
							}
						}
					}
				};
			// On click and mouse move
			document.addEventListener("click", f);
			document.addEventListener("mouseover", f);
			document.addEventListener("keypress", function (e) {
				var key = e.which || e.keyCode;
				if (key === 13) {
					// 13 is enter
					f(e);
				}
				if (key === 27) {
					//27 is esc
					f(e);
				}
			});
		}
	};

	// Component handler registration
	componentHandler.register({
		constructor: MaterialSpeedDial,
		classAsString: "SpeedDial",
		cssClass: MaterialSpeedDial.prototype.classes.speedDial,
		widget: true
	});
})();
